sequenceDiagram
    participant C as Blazor Client
    participant API as Web API
    participant GS as Game Service
    participant QS as Question Service
    participant DB as Azure Table Storage
    
    Note over C,DB: Start New Game Flow
    
    C->>API: POST /api/game/start
    Note right of C: players, difficulty
    
    API->>GS: CreateNewGame
    GS->>GS: Validate players
    GS->>GS: Set first player as King
    
    GS->>QS: GetQuestionsForDifficulty
    QS->>DB: Query Questions table
    DB-->>QS: Questions collection
    QS->>QS: Filter by category
    QS->>QS: Randomize selection
    QS-->>GS: Selected questions
    
    GS->>GS: Create Game object
    GS->>DB: Insert Game record
    DB-->>GS: Success/GameId
    GS-->>API: Game object
    
    API-->>C: 201 Created
    
    Note over C,DB: Submit Answers Flow
    
    C->>API: POST /api/game/answers
    Note right of C: playerId, answers
    
    API->>GS: SubmitAnswers
    GS->>DB: Get Game record
    DB-->>GS: Game object
    
    GS->>GS: Validate game state
    GS->>GS: Store player answers
    GS->>GS: Check if all answered
    
    alt All players answered
        GS->>GS: Calculate scores
        GS->>GS: Update player scores
        GS->>DB: Update Game record
        DB-->>GS: Success
        GS-->>API: Game with scores
        API-->>C: 200 OK
    else Waiting for more answers
        GS->>DB: Update Game record
        DB-->>GS: Success
        GS-->>API: Waiting status
        API-->>C: 202 Accepted
    end
